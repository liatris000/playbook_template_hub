# API レスポンス変更チェックリスト

## 概要

レスポンス形式変更時の波及漏れを防ぐため、実装・型・テスト・ドキュメントを同時に更新する。
変更のたびに使える最小チェックセットを定義する。

## 適用条件

- フィールド名変更
- レスポンスラッパの変更
- エラー形式の追加・変更

## アンチパターン

- サーバー実装だけ更新してクライアントを放置する
- テストモックを旧形式のまま残す
- 互換性方針（破壊的かどうか）を決めない

## 推奨パターン

1. 変更前に影響先（API利用箇所）を列挙する
2. サーバー・クライアント・モックを同一PRで更新する
3. 契約テストで新旧差分を明示する
4. 破壊的変更は移行期間とアナウンスを設定する

## 最小実装例

```md
変更: { items: T[] } -> { data: T[] }

更新対象:
- API ハンドラ
- 型定義（ApiSuccess）
- フロントエンドのパース処理
- テストモック
- ドキュメント（契約仕様）
```

## チェックリスト

- [ ] 影響範囲を一覧化した
- [ ] サーバー・クライアント・テストを同時更新した
- [ ] 契約テストが新仕様で緑になった
- [ ] 変更履歴に breaking/non-breaking を記録した

## 関連テンプレート / プレイブック

- [Response Format Standard](./response-format-standard.md)
- [Auth Template](../../templates/api-contract/auth-template.md)
